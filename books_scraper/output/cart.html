<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart | Jaggi Books</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header class="main-header">
        <div class="header-top">
            <div class="container">
                <div class="logo">
                    <h1><a href="/">Jaggi Books</a></h1>
                    <h2>Your Gateway to Literary Adventures</h2>
                </div>
                <div class="header-actions">
                    <div class="search-bar">
                        <input type="text" placeholder="Search for books...">
                        <button><i class="fas fa-search"></i></button>
                    </div>
                    <div class="cart-icon">
                        <a href="/cart"><i class="fas fa-shopping-cart"></i> <span id="cart-count">0</span></a>
                    </div>
                </div>
            </div>
        </div>
        <nav class="main-nav">
            <div class="container">
                <ul class="nav-links">
                    <li><a href="/">Home</a></li>
                    <li class="dropdown">
                        <a href="#">Categories <i class="fas fa-chevron-down"></i></a>
                        <ul class="dropdown-menu categories">
                            
    
    <li><a href="/category/travel">Travel</a></li>
    
    <li><a href="/category/mystery">Mystery</a></li>
    
    <li><a href="/category/historical_fiction">Historical Fiction</a></li>
    
    <li><a href="/category/sequential_art">Sequential Art</a></li>
    
    <li><a href="/category/classics">Classics</a></li>
    
    <li><a href="/category/philosophy">Philosophy</a></li>
    
    <li><a href="/category/romance">Romance</a></li>
    
    <li><a href="/category/womens_fiction">Womens Fiction</a></li>
    
    <li><a href="/category/fiction">Fiction</a></li>
    
    <li><a href="/category/childrens">Childrens</a></li>
    
    <li><a href="/category/religion">Religion</a></li>
    
    <li><a href="/category/nonfiction">Nonfiction</a></li>
    
    <li><a href="/category/music">Music</a></li>
    
    <li><a href="/category/default">Default</a></li>
    
    <li><a href="/category/science_fiction">Science Fiction</a></li>
    
    <li><a href="/category/sports_and_games">Sports and Games</a></li>
    
    <li><a href="/category/add_a_comment">Add a comment</a></li>
    
    <li><a href="/category/fantasy">Fantasy</a></li>
    
    <li><a href="/category/new_adult">New Adult</a></li>
    
    <li><a href="/category/young_adult">Young Adult</a></li>
    
    <li><a href="/category/science">Science</a></li>
    
    <li><a href="/category/poetry">Poetry</a></li>
    
    <li><a href="/category/paranormal">Paranormal</a></li>
    
    <li><a href="/category/art">Art</a></li>
    
    <li><a href="/category/psychology">Psychology</a></li>
    
    <li><a href="/category/autobiography">Autobiography</a></li>
    
    <li><a href="/category/parenting">Parenting</a></li>
    
    <li><a href="/category/adult_fiction">Adult Fiction</a></li>
    
    <li><a href="/category/humor">Humor</a></li>
    
    <li><a href="/category/horror">Horror</a></li>
    
    <li><a href="/category/history">History</a></li>
    
    <li><a href="/category/food_and_drink">Food and Drink</a></li>
    
    <li><a href="/category/christian_fiction">Christian Fiction</a></li>
    
    <li><a href="/category/business">Business</a></li>
    
    <li><a href="/category/biography">Biography</a></li>
    
    <li><a href="/category/thriller">Thriller</a></li>
    
    <li><a href="/category/contemporary">Contemporary</a></li>
    
    <li><a href="/category/spirituality">Spirituality</a></li>
    
    <li><a href="/category/academic">Academic</a></li>
    
    <li><a href="/category/self_help">Self Help</a></li>
    
    <li><a href="/category/historical">Historical</a></li>
    
    <li><a href="/category/christian">Christian</a></li>
    
    <li><a href="/category/suspense">Suspense</a></li>
    
    <li><a href="/category/short_stories">Short Stories</a></li>
    
    <li><a href="/category/novels">Novels</a></li>
    
    <li><a href="/category/health">Health</a></li>
    
    <li><a href="/category/politics">Politics</a></li>
    
    <li><a href="/category/cultural">Cultural</a></li>
    
    <li><a href="/category/erotica">Erotica</a></li>
    
    <li><a href="/category/crime">Crime</a></li>
    

                        </ul>
                    </li>
                    <li><a href="/new-arrivals">New Arrivals</a></li>
                    <li><a href="/bestsellers">Bestsellers</a></li>
                    <li><a href="/special-offers">Special Offers</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main class="container">
        
    <div class="cart-page">
        <h1>Your Shopping Cart</h1>
        
        <div id="cart-empty" class="cart-empty">
            <p>Your cart is empty.</p>
            <a href="/" class="btn btn-primary">Continue Shopping</a>
        </div>
        
        <div id="cart-items" class="cart-items">
            <!-- Cart items will be loaded here via JavaScript -->
        </div>
        
        <div id="cart-summary" class="cart-summary">
            <div class="cart-total">
                <h3>Order Summary</h3>
                <div class="summary-row">
                    <span>Subtotal:</span>
                    <span id="cart-subtotal">£0.00</span>
                </div>
                <div class="summary-row">
                    <span>Shipping:</span>
                    <span>£4.99</span>
                </div>
                <div class="summary-row total">
                    <span>Total:</span>
                    <span id="cart-total">£0.00</span>
                </div>
                <button id="checkout-btn" class="btn btn-primary">Proceed to Checkout</button>
            </div>
        </div>
    </div>

    </main>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Jaggi Books</h3>
                    <p>Your one-stop destination for quality books at affordable prices.</p>
                </div>
                <!-- Update the footer links as well -->
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href="/about">About Us</a></li>
                        <li><a href="/contact">Contact</a></li>
                        <li><a href="/faq">FAQ</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Connect With Us</h3>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-pinterest"></i></a>
                    </div>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 Jaggi Books. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <script src="/static/js/cart.js"></script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        loadCart();
    });
    
    function loadCart() {
        fetch('/api/cart')
            .then(response => response.json())
            .then(cart => {
                displayCart(cart);
            })
            .catch(error => console.error('Error loading cart:', error));
    }
    
    function displayCart(cart) {
        const cartItemsEl = document.getElementById('cart-items');
        const cartEmptyEl = document.getElementById('cart-empty');
        const cartSummaryEl = document.getElementById('cart-summary');
        const cartSubtotalEl = document.getElementById('cart-subtotal');
        const cartTotalEl = document.getElementById('cart-total');
        
        if (cart.length === 0) {
            cartItemsEl.style.display = 'none';
            cartSummaryEl.style.display = 'none';
            cartEmptyEl.style.display = 'block';
            return;
        }
        
        cartItemsEl.style.display = 'block';
        cartSummaryEl.style.display = 'block';
        cartEmptyEl.style.display = 'none';
        
        // Clear previous items
        cartItemsEl.innerHTML = '';
        
        // Calculate subtotal
        let subtotal = 0;
        
        // Add table header
        const tableHTML = `
            <table class="cart-table">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Total</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="cart-table-body">
                </tbody>
            </table>
        `;
        
        cartItemsEl.innerHTML = tableHTML;
        const tableBodyEl = document.getElementById('cart-table-body');
        
        // Add cart items
        cart.forEach(item => {
            const price = parseFloat(item.price.replace('£', ''));
            const itemTotal = price * item.quantity;
            subtotal += itemTotal;
            
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td class="product-info">
                    <img src="/images/${item.image_filename}" alt="${item.title}">
                    <div>
                        <h4>${item.title}</h4>
                    </div>
                </td>
                <td class="price">${item.price}</td>
                <td class="quantity">
                    <button class="quantity-btn minus" data-upc="${item.upc}">-</button>
                    <span>${item.quantity}</span>
                    <button class="quantity-btn plus" data-upc="${item.upc}">+</button>
                </td>
                <td class="item-total">£${itemTotal.toFixed(2)}</td>
                <td class="remove">
                    <button class="remove-btn" data-upc="${item.upc}">×</button>
                </td>
            `;
            
            tableBodyEl.appendChild(tr);
        });
        
        // Update subtotal and total
        cartSubtotalEl.textContent = `£${subtotal.toFixed(2)}`;
        const total = subtotal + 4.99; // Adding shipping cost
        cartTotalEl.textContent = `£${total.toFixed(2)}`;
        
        // Add event listeners for quantity buttons and remove buttons
        document.querySelectorAll('.quantity-btn.minus').forEach(btn => {
            btn.addEventListener('click', function() {
                const upc = this.dataset.upc;
                updateQuantity(upc, -1);
            });
        });
        
        document.querySelectorAll('.quantity-btn.plus').forEach(btn => {
            btn.addEventListener('click', function() {
                const upc = this.dataset.upc;
                updateQuantity(upc, 1);
            });
        });
        
        document.querySelectorAll('.remove-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const upc = this.dataset.upc;
                removeItem(upc);
            });
        });
    }
    
    function updateQuantity(upc, change) {
        fetch('/api/cart')
            .then(response => response.json())
            .then(cart => {
                const item = cart.find(item => item.upc === upc);
                if (item) {
                    const newQuantity = item.quantity + change;
                    if (newQuantity <= 0) {
                        removeItem(upc);
                    } else {
                        fetch('/api/cart/update', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                upc: upc,
                                quantity: newQuantity
                            })
                        })
                        .then(response => response.json())
                        .then(cart => {
                            displayCart(cart);
                            updateCartCount(cart);
                        })
                        .catch(error => console.error('Error updating cart:', error));
                    }
                }
            })
            .catch(error => console.error('Error loading cart:', error));
    }
    
    function removeItem(upc) {
        fetch('/api/cart/remove', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                upc: upc
            })
        })
        .then(response => response.json())
        .then(cart => {
            displayCart(cart);
            updateCartCount(cart);
        })
        .catch(error => console.error('Error removing item from cart:', error));
    }
    
    function updateCartCount(cart) {
        const cartCount = cart.reduce((total, item) => total + item.quantity, 0);
        document.getElementById('cart-count').textContent = cartCount;
    }
    
    // Checkout button event listener
    document.getElementById('checkout-btn').addEventListener('click', function() {
        alert('Checkout functionality would be implemented here.');
    });
</script>

</body>
</html>